?knitr::opts_knit
?Sys.Date
format(Sys.Date(),"/%Y/%m/%d")
?ggplot2::unit
sexed <- utility(1:10, price = 3)
utility <- function(h, price = NULL, maxhens = 4){
if (is.null(price)){
stop("No value for price and no default.")
}
u <- ifelse(h < maxhens+1, h, maxhens)
return(u/(h*price))
}
sexed <- utility(1:10, price = 3)
sexed
sexed <- utility(1:10, price = 1)
sexed
hens <- (1:n)*dbinom(1:n, size=n, p = 0.5)
straight <- vector("numeric",10)
n = 5
hens <- (1:n)*dbinom(1:n, size=n, p = 0.5)
hens
phens <- dbinom(1:n, size=n, p = 0.5)
phens
phens <- dbinom(0:n, size=n, p = 0.5)
phens
straight <- vector("numeric",10)
for (n in 1:10){
phens <- dbinom(0:n, size=n, p = 0.5)
straight[n] <- sum(utility(0:n)*phens)
}
utility <- function(h, maxhens = 4){
u <- ifelse(h < maxhens+1, h, maxhens)
return(u)
}
for (n in 1:10){
phens <- dbinom(0:n, size=n, p = 0.5)
straight[n] <- sum(utility(0:n)*phens)
}
straight
straight / (1:10)*$2.50
straight / (1:10)*2.50
12/2.50
library(scaler)
library(dplyr) # for %>%
sc_iris <- scale_df(iris) %>%
center_df()
head(sc_iris)
pairs(sc_iris[,-5])
petals_lm <- lm(Petal.Length ~ Petal.Width, data = sc_iris)
summary(iris)
nd <- data.frame(Petal.Width = seq(0.1,2.5,0.1))
pred <- predict(petals_lm, newdata = nd)
nd <- data.frame(Petal.Width = seq(0.1,2.5,0.1))
nd$Petal.Length <- predict(petals_lm, newdata = nd)
ggplot(iris, aes(x = Petal.Width, y = Petal.Length)) +
geom_points() +
geom_path(data=nd)
library(ggplot2)
ggplot(iris, aes(x = Petal.Width, y = Petal.Length)) +
geom_points() +
geom_path(data=nd)
ggplot(iris, aes(x = Petal.Width, y = Petal.Length)) +
geom_point() +
geom_path(data=nd)
To get the logistic model allow $b(N)$ and $d(N)$ to be linear functions of $N$. As long as $db/dN < 0$, $dd/dN > 0$, and $b(0) > d(0)$[^1] this model has a positive equilibrium point which we call $K$, the carrying capacity. Now we usually assume these changes are due to intra-specific competition. But predation causes death, so what kind of predation can be accommodated in this model without changing the fundamental dynamics?
a <- 0.1
h <- 0.1
P <- 1
df <- data.frame(N = 0:100,
f1 = a*P,
f2 = (a*P)/(1+a*h*N))
?tbl_df
?dplyr::tbl_df
N <- 0:100
df <- data.frame(N = N,
f1 = a*P,
f2 = (a*P)/(1+a*h*N))
ggplot2(df, aes(x = N, y = f1)) +
geom_line() + geom_line(aes(y = f2)) +
theme_minimal() +
xlab("Population Size") +
ylab("Per capita death rate")
library(ggplot2)
ggplot2(df, aes(x = N, y = f1)) +
geom_line() + geom_line(aes(y = f2)) +
theme_minimal() +
xlab("Population Size") +
ylab("Per capita death rate")
ggplot(df, aes(x = N, y = f1)) +
geom_line() + geom_line(aes(y = f2)) +
theme_minimal() +
xlab("Population Size") +
ylab("Per capita death rate")
d1 <- 0.05
d2 <- 0.001
df <- data.frame(N = N)
df <- mutate(df,
f1 = a*P,
f2 = (a*P)/(1+a*h*N),
d = d1 + d2*N,
f2_d = f2 + d)
library(dplyr)
df <- mutate(df,
f1 = a*P,
f2 = (a*P)/(1+a*h*N),
d = d1 + d2*N,
f2_d = f2 + d)
library(tidyr)
df <- data.frame(N = N)
df <- mutate(df,
f1 = a*P,
f2 = (a*P)/(1+a*h*N),
d = d1 + d2*N,
f2_d = f2 + d) %>%
gather(response, e, 2:5)
df
?geom_line
ggplot(df, aes(x = N, y = response, linetype = response)) +
geom_line() +
theme_minimal() +
xlab("Population Size") +
ylab("Per capita death rate")
ggplot(df, aes(x = N, y = e, linetype = response)) +
geom_line() +
theme_minimal() +
xlab("Population Size") +
ylab("Per capita death rate")
a <- 0.1
h <- 0.2
P <- 1
d1 <- 0.05
d2 <- 0.0005
df <- data.frame(N = N)
df <- mutate(df,
f1 = a*P,
f2 = (a*P)/(1+a*h*N),
d = d1 + d2*N,
f2_d = f2 + d) %>%
gather(response, e, -N)
ggplot(df, aes(x = N, y = e, linetype = response)) +
geom_line() +
theme_minimal() +
xlab("Population Size") +
ylab("Per capita death rate")
h <- 0.3
df <- data.frame(N = N)
df <- mutate(df,
f1 = a*P,
f2 = (a*P)/(1+a*h*N),
d = d1 + d2*N,
f2_d = f2 + d) %>%
gather(response, e, -N)
ggplot(df, aes(x = N, y = e, linetype = response)) +
geom_line() +
theme_minimal() +
xlab("Population Size") +
ylab("Per capita death rate")
?scale_linetype_discrete
ggplot(df, aes(x = N, y = e, linetype = response)) +
geom_line() +
theme_minimal() +
xlab("Population Size") +
ylab("Per capita death rate") +
scale_linetype_discrete(name = element_blank(), labels = c("Competition","Predation","Competition + Predation")) +
theme(legend.position = "bottom", legend.box = "horizontal")
a <- 0.1
h <- 0.3
P <- 1
d1 <- 0.05
d2 <- 0.0005
df <- data.frame(N = N)
df <- mutate(df,
f2 = (a*P)/(1+a*h*N),
d = d1 + d2*N,
f2_d = f2 + d) %>%
gather(response, e, -N)
ggplot(df, aes(x = N, y = e, linetype = response)) +
geom_line() +
theme_minimal() +
xlab("Population Size") +
ylab("Per capita death rate") +
scale_linetype_discrete(name = element_blank(), labels = c("Competition","Predation","Competition + Predation")) +
theme(legend.position = "bottom", legend.box = "horizontal")
a <- 0.1
h <- 0.3
P <- 1
d1 <- 0.05
d2 <- 0.0005
b1 <- 0.12
b2 <- -a^2*h*P
df <- data.frame(N = N)
df <- mutate(df,
f2 = (a*P)/(1+a*h*N),
d = d1 + d2*N,
f2_d = f2 + d,
b = b1 + b2*N) %>%
gather(response, e, -N)
ggplot(df, aes(x = N, y = e, linetype = response)) +
geom_line() +
theme_minimal() +
xlab("Population Size") +
ylab("Per capita death rate") +
scale_linetype_discrete(name = element_blank(), labels = c("Competition","Predation","Competition + Predation")) +
theme(legend.position = "bottom", legend.box = "horizontal")
-a^2*h*P
a <- 0.1
h <- 0.5
P <- 1
d1 <- 0.05
d2 <- 0.0005
b1 <- 0.12
b2 <- -0.0005
df <- data.frame(N = N)
df <- mutate(df,
f2 = (a*P)/(1+a*h*N),
d = d1 + d2*N,
f2_d = f2 + d,
b = b1 + b2*N) %>%
gather(response, e, -N)
ggplot(df, aes(x = N, y = e, linetype = response)) +
geom_line() +
theme_minimal() +
xlab("Population Size") +
ylab("Per capita death rate") +
scale_linetype_discrete(name = element_blank(), labels = c("Competition","Predation","Competition + Predation")) +
theme(legend.position = "bottom", legend.box = "horizontal")
a <- 0.1
h <- 0.5
P <- 1
d1 <- 0.05
d2 <- 0.0005
b1 <- 0.13
b2 <- -0.0001
df <- data.frame(N = N)
df <- mutate(df,
f2 = (a*P)/(1+a*h*N),
d = d1 + d2*N,
f2_d = f2 + d,
b = b1 + b2*N) %>%
gather(response, e, N, f2_d, b)
ggplot(df, aes(x = N, y = e, linetype = response)) +
geom_line() +
theme_minimal() +
xlab("Population Size") +
ylab("Per capita death rate") +
scale_linetype_discrete(name = element_blank(), labels = c("Competition","Predation","Competition + Predation")) +
theme(legend.position = "bottom", legend.box = "horizontal")
a <- 0.1
h <- 0.5
P <- 1
d1 <- 0.05
d2 <- 0.0005
b1 <- 0.13
b2 <- -0.0001
df <- data.frame(N = N)
df <- mutate(df,
f2 = (a*P)/(1+a*h*N),
d = d1 + d2*N,
f2_d = f2 + d,
b = b1 + b2*N) %>%
gather(response, e, -N, f2_d, b)
ggplot(df, aes(x = N, y = e, linetype = response)) +
geom_line() +
theme_minimal() +
xlab("Population Size") +
ylab("Per capita rates") +
scale_linetype_discrete(name = element_blank(), labels = c("Birth rate", "Death rate")) +
theme(legend.position = "bottom", legend.box = "horizontal")
df
?gather
a <- 0.1
h <- 0.5
P <- 1
d1 <- 0.05
d2 <- 0.0005
b1 <- 0.13
b2 <- -0.0001
df <- data.frame(N = N)
df <- mutate(df,
f2 = (a*P)/(1+a*h*N),
d = d1 + d2*N,
f2_d = f2 + d,
b = b1 + b2*N) %>%
gather(response, e, -N, -f2, -d, f2_d, b)
ggplot(df, aes(x = N, y = e, linetype = response)) +
geom_line() +
theme_minimal() +
xlab("Population Size") +
ylab("Per capita rates") +
scale_linetype_discrete(name = element_blank(), labels = c("Birth rate", "Death rate")) +
theme(legend.position = "bottom", legend.box = "horizontal")
a <- 0.1
h <- 0.5
P <- 1
d1 <- 0.05
d2 <- 0.0005
b1 <- 0.13
b2 <- -0.0003
df <- data.frame(N = N)
df <- mutate(df,
f2 = (a*P)/(1+a*h*N),
d = d1 + d2*N,
f2_d = f2 + d,
b = b1 + b2*N) %>%
gather(response, e, -N, -f2, -d, f2_d, b)
ggplot(df, aes(x = N, y = e, linetype = response)) +
geom_line() +
theme_minimal() +
xlab("Population Size") +
ylab("Per capita rates") +
scale_linetype_discrete(name = element_blank(), labels = c("Birth rate", "Death rate")) +
theme(legend.position = "bottom", legend.box = "horizontal")
b2 <- -0.0001
a <- 0.1
h <- 0.5
P <- 1
d1 <- 0.05
d2 <- 0.0005
b1 <- 0.11
b2 <- -0.0001
df <- data.frame(N = N)
df <- mutate(df,
f2 = (a*P)/(1+a*h*N),
d = d1 + d2*N,
f2_d = f2 + d,
b = b1 + b2*N) %>%
gather(response, e, -N, -f2, -d, f2_d, b)
ggplot(df, aes(x = N, y = e, linetype = response)) +
geom_line() +
theme_minimal() +
xlab("Population Size") +
ylab("Per capita rates") +
scale_linetype_discrete(name = element_blank(), labels = c("Birth rate", "Death rate")) +
theme(legend.position = "bottom", legend.box = "horizontal")
a <- 0.1
h <- 0.5
P <- 1
d1 <- 0.05
d2 <- 0.0005
b1 <- 0.12
b2 <- -0.0002
df <- data.frame(N = N)
df <- mutate(df,
f2 = (a*P)/(1+a*h*N),
d = d1 + d2*N,
f2_d = f2 + d,
b = b1 + b2*N) %>%
gather(response, e, -N, -f2, -d, f2_d, b)
ggplot(df, aes(x = N, y = e, linetype = response)) +
geom_line() +
theme_minimal() +
xlab("Population Size") +
ylab("Per capita rates") +
scale_linetype_discrete(name = element_blank(), labels = c("Birth rate", "Death rate")) +
theme(legend.position = "bottom", legend.box = "horizontal")
?root
?solve
?find.root
library(rootSolve)
install.packages("rootSolve")
library(rootSolve)
?uniroot.all
dN_Ndt <- function(N, a, h, P, d1, d2, b1, b2){
f2 = (a*P)/(1+a*h*N)
d = d1 + d2*N
f2_d = f2 + d
b = b1 + b2*N
}
roots <- uniroot.all(dN_Ndt, c(1,100) )
roots <- uniroot.all(dN_Ndt, c(1,100), a = a, h = h, P = P, d1 = d1, d2 = d2, b1 = b1, b2 = b2 )
roots
dN_Ndt(10, a = a, h = h, P = P, d1 = d1, d2 = d2, b1 = b1, b2 = b2)
debug(dN_Ndt)
dN_Ndt(10, a = a, h = h, P = P, d1 = d1, d2 = d2, b1 = b1, b2 = b2)
a
P
h
N
f2
d
f2_d
dN_Ndt <- function(N, a, h, P, d1, d2, b1, b2){
f2 = (a*P)/(1+a*h*N)
d = d1 + d2*N
f2_d = f2 + d
b = b1 + b2*N
return(b - f2_d)
}
dN_Ndt(10, a = a, h = h, P = P, d1 = d1, d2 = d2, b1 = b1, b2 = b2)
roots <- uniroot.all(dN_Ndt, c(1,100), a = a, h = h, P = P, d1 = d1, d2 = d2, b1 = b1, b2 = b2 )
roots
equilibria <- data.frame(N = roots)
equilibria <- mutate(e = b1 + b2*N)
equilibria <- mutate(equilibria, e = b1 + b2*N)
ggplot(df, aes(x = N, y = e, linetype = response)) +
geom_line() +
theme_minimal() +
xlab("Population Size") +
ylab("Per capita rates") +
scale_linetype_discrete(name = element_blank(), labels = c("Birth rate", "Death rate")) +
theme(legend.position = "bottom", legend.box = "horizontal") +
geom_point(data=equilibria)
ggplot(df, aes(x = N, y = e, linetype = response)) +
geom_line() +
theme_minimal() +
xlab("Population Size") +
ylab("Per capita rates") +
scale_linetype_discrete(name = element_blank(), labels = c("Birth rate", "Death rate")) +
theme(legend.position = "bottom", legend.box = "horizontal")
ggplot(df, aes(x = N, y = e, linetype = response)) +
geom_line() +
theme_minimal() +
xlab("Population Size") +
ylab("Per capita rates") +
scale_linetype_discrete(name = element_blank(), labels = c("Birth rate", "Death rate")) +
theme(legend.position = "bottom", legend.box = "horizontal") +
geom_point(aes(x=N, y = e), data=equilibria)
ggplot(df, aes(x = N, y = e, linetype = response)) +
geom_line() +
theme_minimal() +
xlab("Population Size") +
ylab("Per capita rates") +
scale_linetype_discrete(name = element_blank(), labels = c("Birth rate", "Death rate")) +
theme(legend.position = "bottom", legend.box = "horizontal") +
geom_point(aes(x=N, y = e), data=equilibria, linetype = 1)
ggplot(df, aes(x = N, y = e)) +
geom_line(aes(linetype = response)) +
theme_minimal() +
xlab("Population Size") +
ylab("Per capita rates") +
scale_linetype_discrete(name = element_blank(), labels = c("Birth rate", "Death rate")) +
theme(legend.position = "bottom", legend.box = "horizontal") +
geom_point(aes(x=N, y = e), data=equilibria)
?annotate
?geom_text
equilibria <- data.frame(N = roots, label = c("Pit","K"))
equilibria <- mutate(equilibria, e = b1 + b2*N)
ggplot(df, aes(x = N, y = e)) +
geom_line(aes(linetype = response)) +
theme_minimal() +
xlab("Population Size") +
ylab("Per capita rates") +
scale_linetype_discrete(name = element_blank(), labels = c("Birth rate", "Death rate")) +
theme(legend.position = "bottom", legend.box = "horizontal") +
geom_point(aes(x=N, y = e), size = 2, data=equilibria) +
geom_text(aes(x=N, y = e, label=label), size = 2, data=equilibria, show.legend = FALSE)
ggplot(df, aes(x = N, y = e)) +
geom_line(aes(linetype = response)) +
theme_minimal() +
xlab("Population Size") +
ylab("Per capita rates") +
scale_linetype_discrete(name = element_blank(), labels = c("Birth rate", "Death rate")) +
theme(legend.position = "bottom", legend.box = "horizontal") +
geom_point(aes(x=N, y = e), size = 2, data=equilibria) +
geom_text(aes(x=N, y = e, label=label),
size = 3, data=equilibria,
nudge_x = c(2,0), nudge_y = c(0.01, 0.01),
show.legend = FALSE)
ggplot(df, aes(x = N, y = e)) +
geom_line(aes(linetype = response)) +
theme_minimal() +
xlab("Population Size") +
ylab("Per capita rates") +
scale_linetype_discrete(name = element_blank(), labels = c("Birth rate", "Death rate")) +
theme(legend.position = "bottom", legend.box = "horizontal") +
geom_point(aes(x=N, y = e), size = 2, data=equilibria) +
geom_text(aes(x=N, y = e, label=label),
size = 12, data=equilibria,
nudge_x = c(2,0), nudge_y = c(0.003, 0.003),
show.legend = FALSE)
ggplot(df, aes(x = N, y = e)) +
geom_line(aes(linetype = response)) +
theme_minimal() +
xlab("Population Size") +
ylab("Per capita rates") +
scale_linetype_discrete(name = element_blank(), labels = c("Birth rate", "Death rate")) +
theme(legend.position = "bottom", legend.box = "horizontal") +
geom_point(aes(x=N, y = e), size = 2, data=equilibria) +
geom_text(aes(x=N, y = e, label=label),
data=equilibria,
nudge_x = c(2,0), nudge_y = c(0.003, 0.003),
show.legend = FALSE)
?geom_line
equilibria <- data.frame(N = roots, label = c("Pit","K"))
equilibria <- mutate(equilibria, e = b1 + b2*N)
ggplot(df, aes(x = N, y = e)) +
geom_line(aes(linetype = response), size = 2) +
theme_minimal() +
xlab("Population Size") +
ylab("Per capita rates") +
scale_linetype_discrete(name = element_blank(), labels = c("Birth rate", "Death rate")) +
theme(legend.position = "bottom", legend.box = "horizontal") +
geom_point(aes(x=N, y = e), size = 2, data=equilibria) +
geom_text(aes(x=N, y = e, label=label),
data=equilibria,
nudge_x = c(2,0), nudge_y = c(0.003, 0.003),
show.legend = FALSE) +
geom_segment(aes(x = N, y = e, xend = 0, yend = e), data = equilibria[1,],arrow = arrow(length = unit(0.1,"cm")))
ggplot(df, aes(x = N, y = e)) +
geom_line(aes(linetype = response), size = 1) +
theme_minimal() +
xlab("Population Size") +
ylab("Per capita rates") +
scale_linetype_discrete(name = element_blank(), labels = c("Birth rate", "Death rate")) +
theme(legend.position = "bottom", legend.box = "horizontal") +
geom_point(aes(x=N, y = e), size = 3, data=equilibria) +
geom_text(aes(x=N, y = e, label=label),
data=equilibria,
nudge_x = c(2,0), nudge_y = c(0.003, 0.003),
show.legend = FALSE) +
geom_segment(aes(x = N, y = e, xend = 0, yend = e), data = equilibria[1,],arrow = arrow(length = unit(0.5,"cm")))
?render_jekyll
