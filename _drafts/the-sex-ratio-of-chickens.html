<p>I got the following email the other day</p>
<blockquote>
<p>I’m trying to find the answer to a pretty simple question, but I’m having a hard time finding a reputable source online, so I Googled “best ornithology schools” and you all popped up! I’m wondering if the sex ratio for egg-laying chickens is about equal, 1 male chick : 1 female chick born.</p>
</blockquote>
<p>Obviously a fan! I tried the same search and I must say we didn’t exactly pop to the top.</p>
<p>I searched ‘sex ratio chickens’ and the first link was <a href="http://www.jstor.org/stable/2458081" title="The primary sex ratio in domestic chickens">Hays (1945)</a>. From <em>The American Naturalist</em> no less, so a peer reviewed journal and a credible source. In the introduction he summarizes a range of previous sources with estimates varying from 48.77 % males to 51.38 % males. So approximately 50/50. In his own work (which is behind a paywall so not publicly available) he reports 49.7 % males. His methods were</p>
<blockquote>
<p>In the ten-year period from 1935 to 1944 a total of 39 pure- bred Rhode Island Red females mated to pure-bred Rhode Island Red males qualified for study. Each female had a perfect record in fertility and hatchability and produced ten or more chicks during March and April</p>
</blockquote>
<p>This is 1945, so statistics are largely absent. He does suggest that the standard error of the difference between yearly sex ratios and 50 % is 1.42. I think that’s just treating each year as a single observation. But the data are given.</p>
<table>
<caption>Sex ratios of hatched chicks.</caption>
<thead>
<tr class="header">
<th align="right">Year</th>
<th align="right"># of Dams</th>
<th align="right"># of Male Chicks</th>
<th align="right"># of Female Chicks</th>
<th align="right">Sex not determined</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1944</td>
<td align="right">8</td>
<td align="right">70</td>
<td align="right">78</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="right">1943</td>
<td align="right">4</td>
<td align="right">43</td>
<td align="right">45</td>
<td align="right">9</td>
</tr>
<tr class="odd">
<td align="right">1942</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">1941</td>
<td align="right">4</td>
<td align="right">51</td>
<td align="right">47</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">1940</td>
<td align="right">6</td>
<td align="right">92</td>
<td align="right">85</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="right">1939</td>
<td align="right">5</td>
<td align="right">50</td>
<td align="right">48</td>
<td align="right">10</td>
</tr>
<tr class="odd">
<td align="right">1938</td>
<td align="right">3</td>
<td align="right">29</td>
<td align="right">28</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">1937</td>
<td align="right">2</td>
<td align="right">22</td>
<td align="right">22</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="right">1936</td>
<td align="right">3</td>
<td align="right">21</td>
<td align="right">34</td>
<td align="right">14</td>
</tr>
<tr class="even">
<td align="right">1935</td>
<td align="right">4</td>
<td align="right">54</td>
<td align="right">51</td>
<td align="right">4</td>
</tr>
</tbody>
</table>
<p>So treating each year as a normally distributed observation I get</p>
<pre class="r"><code>sexratio &lt;- with(table1, 100 * Males / (Females + Males))
sd(sexratio - 50, na.rm = TRUE) / sqrt(9)</code></pre>
<pre><code>## [1] 1.45542</code></pre>
<pre class="r"><code>t.test(sexratio - 50)</code></pre>
<pre><code>## 
##  One Sample t-test
## 
## data:  sexratio - 50
## t = -0.63463, df = 8, p-value = 0.5434
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  -4.279855  2.432553
## sample estimates:
##  mean of x 
## -0.9236509</code></pre>
<p>So I get a slightly different standard error, but either way it isn’t significantly different from 50 %. However this is ignoring a huge amount of information in this data. For example, one thing that’s cool is the variation between years.</p>
<pre class="r"><code>library(lme4)</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre class="r"><code>year.model &lt;- glmer(cbind(Males,Females)~1 + (1|Year), data = table1, family=binomial)
summary(year.model)</code></pre>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [glmerMod]
##  Family: binomial  ( logit )
## Formula: cbind(Males, Females) ~ 1 + (1 | Year)
##    Data: table1
## 
##      AIC      BIC   logLik deviance df.resid 
##     52.5     52.9    -24.2     48.5        7 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -1.7018 -0.1485  0.1845  0.3634  0.6179 
## 
## Random effects:
##  Groups Name        Variance Std.Dev.
##  Year   (Intercept) 0        0       
## Number of obs: 9, groups:  Year, 9
## 
## Fixed effects:
##             Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept) -0.01379    0.06781  -0.203    0.839</code></pre>
<p>So same conclusion as before. The intercept is not significantly different from 0, which is what we expect for 50/50 sex ratio. In addition, there’s no evidence of significant variation between years. The estimated random effect variance is zero.</p>
<p>Hays also has a table of data for 11 hens with complete records of sex of chick. The sex ratio there extends from 22 % up to 65 %! So repeating the same thing</p>
<pre class="r"><code>ind.model &lt;- glmer(cbind(Males,Females)~1 + (1|Hen), data = table2, family=binomial)
summary(ind.model)</code></pre>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [glmerMod]
##  Family: binomial  ( logit )
## Formula: cbind(Males, Females) ~ 1 + (1 | Hen)
##    Data: table2
## 
##      AIC      BIC   logLik deviance df.resid 
##     71.7     72.5    -33.9     67.7        9 
## 
## Scaled residuals: 
##      Min       1Q   Median       3Q      Max 
## -0.70263 -0.17421 -0.02554  0.04426  0.94412 
## 
## Random effects:
##  Groups Name        Variance Std.Dev.
##  Hen    (Intercept) 0.7791   0.8827  
## Number of obs: 11, groups:  Hen, 11
## 
## Fixed effects:
##             Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)   0.2053     0.2978   0.689    0.491</code></pre>
<p>Again, the intercept is not significantly different from zero, so across the entire population the average sex ratio is not different from 50/50. However here we do see a non-zero variance between hens. Individual hens may have sex ratios that deviate from 50/50. It’s a bit hard to interpret that standard deviation because it is on a log-odds scale.</p>
<p>Imagine you are ordering chicks ‘straight run’, which means without sexing. This is the cheapest way to get chicks because the expertise to sex chicks at a young age is expensive. You want 4 hens, so you decide to order 8 chicks. With a 50/50 sex ratio you’ll get 4 hens, right?</p>
<p>Wrong! You can get any number of hens between 0 and 8! 4 is just the most likely outcome. In fact, nearly 4 out of 10 orders you’ll get less than 4 hens. Of course, you could also do better; in 4 out of 10 orders you’ll get more than 4 hens. The probabilities of each outcome are</p>
<pre class="r"><code>binomial_probs = data.frame(hens=0:8,
                            d = dbinom(0:8, 8, 0.5),
                            p = pbinom(0:8, 8, 0.5))

knitr::kable(binomial_probs, digits = 2)</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">hens</th>
<th align="right">d</th>
<th align="right">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0.03</td>
<td align="right">0.04</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">0.11</td>
<td align="right">0.14</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">0.22</td>
<td align="right">0.36</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">0.27</td>
<td align="right">0.64</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">0.22</td>
<td align="right">0.86</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">0.11</td>
<td align="right">0.96</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">0.03</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">0.00</td>
<td align="right">1.00</td>
</tr>
</tbody>
</table>
<p>However, that assumes that there is no variation among hens, which we know is false. I can simulate data from the fitted model to see if this variation makes a difference to the probability of getting less than 4 hens.</p>
<pre class="r"><code>sims &lt;- simulate(ind.model, 1000)
lessthan4 &lt;- sapply(sims, function(x) sum(x[,&quot;F&quot;]))</code></pre>
